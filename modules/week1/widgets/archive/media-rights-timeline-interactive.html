<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Major Media Rights Deals Timeline 2020-2035</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Geist:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --color-neutral-50: #fafafa;
            --color-neutral-100: #f5f5f5;
            --color-neutral-200: #e5e5e5;
            --color-neutral-300: #d4d4d4;
            --color-neutral-400: #a3a3a3;
            --color-neutral-500: #737373;
            --color-neutral-600: #525252;
            --color-neutral-700: #404040;
            --color-neutral-800: #262626;
            --color-neutral-900: #171717;
            --color-error: #ef4444;
            --color-success: #c0d1cd;
            --color-warning: #f0ede0;
            --color-info: #bfe5e7;
            --color-purple: #d5cae0;
            --color-green: #c0d1cd;
            --color-turquoise: #bfe5e7;
            --color-sand: #f0ede0;
            --color-dark-gray: #374151;
            --color-darker-gray: #1f2937;
            --color-green: #059669;
            --color-green-dark: #047857;
            --color-text-primary: #2d3748;
            --color-text-secondary: #6b7280;
            --color-bg-gray: #f9fafb;
            --color-border: #d1d5db;
            --color-border-light: #e5e7eb;
            --border-radius: 8px;
            --border-radius-sm: 4px;
        }

        *:focus {
            outline: 2px solid #3182ce;
            outline-offset: 2px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Geist', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: white;
            color: var(--color-text-primary);
            padding: 2rem;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: var(--color-bg-gray);
            border: 1px solid var(--color-border);
            border-radius: 8px;
            padding: 2rem;
        }

        h1 {
            color: var(--color-darker-gray);
            margin-bottom: 0.5rem;
            font-size: 2rem;
        }

        .subtitle {
            color: var(--color-text-secondary);
            margin-bottom: 2rem;
            font-size: 1rem;
        }

        .controls {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }

        .filter-btn {
            padding: 0.5rem 1rem;
            background: white;
            border: 2px solid var(--color-border);
            border-radius: 4px;
            color: var(--color-text-primary);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.9rem;
            font-family: inherit;
        }

        .filter-btn:hover {
            border-color: var(--color-text-primary);
            background: var(--color-bg-gray);
        }

        .filter-btn.active {
            background: var(--color-neutral-800);
            color: white;
            border-color: var(--color-neutral-800);
        }

        .filter-btn:hover:not(.active) {
            background: var(--color-sand);
            border-color: var(--color-neutral-400);
        }


        .timeline-container {
            background: white;
            padding: 2rem;
            border: 1px solid var(--color-border);
            border-radius: 8px;
        }

        .year-labels {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1rem;
            padding: 0 80px 0 120px;
            font-weight: 600;
            color: var(--color-text-secondary);
            font-size: 0.9rem;
        }

        .timeline-row {
            display: flex;
            align-items: center;
            margin-bottom: 1.5rem;
            position: relative;
            min-height: 60px;
        }

        .league-icon {
            width: 80px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .league-icon img {
            max-width: 100%;
            max-height: 100%;
        }

        .deals-track {
            flex: 1;
            position: relative;
            height: 60px;
            margin-left: 1rem;
        }

        .year-grid {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: grid;
            grid-template-columns: repeat(16, 1fr);
            pointer-events: none;
        }

        .year-line {
            border-right: 1px dashed var(--color-border-light);
        }

        .deal-bar {
            position: absolute;
            height: 26px;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            padding: 0 8px;
            font-size: 0.75rem;
            font-weight: 600;
            color: white;
            overflow: hidden;
            white-space: nowrap;
        }

        .deal-bar.traditional {
            background: linear-gradient(135deg, var(--color-dark-gray) 0%, var(--color-darker-gray) 100%);
            border: 1px solid var(--color-darker-gray);
        }

        .deal-bar.streaming {
            background: linear-gradient(135deg, var(--color-green) 0%, var(--color-green-dark) 100%);
            border: 1px solid var(--color-green-dark);
        }

        .deal-bar:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 10;
        }


        .deal-bar.top {
            top: 2px;
        }

        .deal-bar.bottom {
            bottom: 2px;
        }

        .value-label {
            position: absolute;
            right: -60px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--color-text-primary);
            white-space: nowrap;
        }

        .tooltip {
            position: fixed;
            background: var(--color-darker-gray);
            color: white;
            padding: 1rem;
            border-radius: 6px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
            z-index: 1000;
            max-width: 320px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s;
        }

        .tooltip.visible {
            opacity: 1;
        }

        .tooltip h3 {
            font-size: 1rem;
            margin-bottom: 0.5rem;
            color: white;
            border-bottom: 1px solid rgba(255,255,255,0.2);
            padding-bottom: 0.5rem;
        }

        .tooltip-row {
            display: flex;
            justify-content: space-between;
            margin: 0.3rem 0;
            font-size: 0.85rem;
        }

        .tooltip-label {
            color: var(--color-border);
        }

        .tooltip-value {
            font-weight: 600;
            color: white;
        }

        .legend {
            display: flex;
            gap: 2rem;
            margin-top: 2rem;
            padding: 1rem;
            background: var(--color-neutral-50);
            border-radius: 6px;
            justify-content: center;
            border: 1px solid var(--color-neutral-200);
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
        }

        .legend-box {
            width: 24px;
            height: 16px;
            border-radius: 3px;
        }

        .legend-box.traditional {
            background: linear-gradient(135deg, var(--color-dark-gray) 0%, var(--color-darker-gray) 100%);
        }

        .legend-box.streaming {
            background: linear-gradient(135deg, var(--color-green) 0%, var(--color-green-dark) 100%);
        }

        .year-slider {
            margin: 2rem 0 1rem 0;
            padding: 0 120px;
        }

        .slider-label {
            font-weight: 600;
            color: var(--color-text-primary);
            margin-bottom: 0.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .current-year {
            font-size: 1.2rem;
            color: var(--color-green);
        }

        input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: var(--color-border);
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--color-green);
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }

        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--color-green);
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }

        .stats-panel {
            margin-top: 2rem;
            padding: 1.5rem;
            background: white;
            border: 1px solid var(--color-border);
            border-radius: 8px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-top: 1rem;
        }

        .stat-item {
            text-align: center;
            padding: 1rem;
            background: var(--color-neutral-50);
            border-radius: 6px;
            border: 1px solid var(--color-neutral-200);
        }

        .stat-item:nth-child(1) { border-left: 4px solid var(--color-neutral-600); }
        .stat-item:nth-child(2) { border-left: 4px solid var(--color-neutral-500); }
        .stat-item:nth-child(3) { border-left: 4px solid var(--color-green); }
        .stat-item:nth-child(4) { border-left: 4px solid var(--color-neutral-400); }

        .stat-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--color-text-primary);
            margin-bottom: 0.3rem;
        }

        .stat-label {
            font-size: 0.85rem;
            color: var(--color-text-secondary);
            font-weight: 500;
        }

        @media (max-width: 1024px) {
            .year-labels {
                padding: 0 60px 0 100px;
                font-size: 0.75rem;
            }

            .value-label {
                font-size: 0.75rem;
                right: -50px;
            }

            .league-icon {
                width: 60px;
                height: 50px;
            }
        }

        /* Mobile Cards - hidden on desktop */
        .mobile-cards {
            display: none;
        }

        .mobile-card {
            background: white;
            border: 1px solid var(--color-border);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
            border-left: 4px solid var(--color-dark-gray);
        }

        .mobile-card.streaming {
            border-left-color: var(--color-green);
        }

        .mobile-card.hidden {
            display: none;
        }

        .mobile-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0.75rem;
        }

        .mobile-card-league {
            font-weight: 700;
            font-size: 1.1rem;
            color: var(--color-text-primary);
        }

        .mobile-card-badge {
            font-size: 0.7rem;
            font-weight: 600;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            text-transform: uppercase;
        }

        .mobile-card-badge.traditional {
            background: var(--color-dark-gray);
            color: white;
        }

        .mobile-card-badge.streaming {
            background: var(--color-green);
            color: white;
        }

        .mobile-card-broadcaster {
            font-weight: 600;
            color: var(--color-text-primary);
            margin-bottom: 0.5rem;
        }

        .mobile-card-details {
            display: flex;
            gap: 1.5rem;
            font-size: 0.9rem;
            color: var(--color-text-secondary);
        }

        .mobile-card-detail {
            display: flex;
            flex-direction: column;
        }

        .mobile-card-detail-label {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--color-text-secondary);
        }

        .mobile-card-detail-value {
            font-weight: 600;
            color: var(--color-text-primary);
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            h1 {
                font-size: 1.5rem;
            }

            /* Hide timeline, show cards */
            .timeline-container {
                display: none;
            }

            .mobile-cards {
                display: block;
            }

            .year-slider {
                padding: 0;
                margin: 1.5rem 0;
            }

            /* Stack filter buttons */
            .controls {
                flex-direction: column;
            }

            .filter-group {
                flex-wrap: wrap;
            }

            .filter-btn {
                flex: 1 1 auto;
                min-width: 80px;
                text-align: center;
            }

            .stats-grid {
                grid-template-columns: 1fr 1fr;
            }

            .stat-value {
                font-size: 1.4rem;
            }
        }

        @media (max-width: 480px) {
            .filter-group {
                width: 100%;
            }

            .filter-group > span {
                width: 100%;
                margin-bottom: 0.5rem;
            }

            .mobile-card-details {
                flex-wrap: wrap;
                gap: 1rem;
            }

            .mobile-card-detail {
                min-width: 45%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Major Media Rights Deals, 2020–2035</h1>
        <p class="subtitle">Interactive timeline showing the evolution from traditional broadcasters to streaming platforms</p>

        <div class="instructions" style="background: var(--color-neutral-50); padding: 1rem 1.5rem; border-radius: 8px; margin-bottom: 1.5rem; border-left: 4px solid var(--color-neutral-400);">
            <p style="margin: 0; color: var(--color-neutral-700); font-size: 0.9rem;">
                <strong>How to use:</strong> Hover over any deal bar to see details. Use the filters to focus on specific leagues or platform types.
                Drag the year slider to highlight which deals are active in any given year. Notice how streaming deals (green) increasingly overlap with traditional broadcasts (gray) as leagues diversify their media partnerships.
            </p>
        </div>

        <div class="controls">
            <div class="filter-group">
                <span style="font-weight: 600; color: var(--color-text-secondary);">Filter by League:</span>
                <button class="filter-btn active" onclick="filterLeague('all')" data-league="all">All Leagues</button>
                <button class="filter-btn" onclick="filterLeague('NHL')" data-league="NHL">NHL</button>
                <button class="filter-btn" onclick="filterLeague('NBA')" data-league="NBA">NBA</button>
                <button class="filter-btn" onclick="filterLeague('NFL')" data-league="NFL">NFL</button>
                <button class="filter-btn" onclick="filterLeague('MLB')" data-league="MLB">MLB</button>
            </div>
        </div>

        <div class="controls">
            <div class="filter-group">
                <span style="font-weight: 600; color: var(--color-text-secondary);">Filter by Type:</span>
                <button class="filter-btn active" onclick="filterType('all')" data-type="all">All Platforms</button>
                <button class="filter-btn" onclick="filterType('traditional')" data-type="traditional">Traditional Only</button>
                <button class="filter-btn" onclick="filterType('streaming')" data-type="streaming">Streaming Only</button>
            </div>
            <button class="reset-btn" onclick="resetAll()" style="padding: 0.5rem 1rem; background: var(--color-neutral-800); color: white; border: none; border-radius: 4px; font-weight: 600; cursor: pointer; font-family: inherit;">Reset All</button>
        </div>

        <div class="year-slider">
            <div class="slider-label">
                <span>Highlight Deals Active in Year:</span>
                <span class="current-year" id="year-display">2025</span>
            </div>
            <input type="range" id="year-slider" min="2020" max="2035" value="2025" step="1"
                   aria-label="Select year to highlight active deals">
        </div>

        <div class="timeline-container">
            <div class="year-labels">
                <span>2020</span>
                <span>2025</span>
                <span>2030</span>
                <span>2035</span>
            </div>

            <div id="timeline-content">
                <!-- NHL -->
                <div class="timeline-row" data-league="NHL">
                    <div class="league-icon">
                        <svg viewBox="0 0 100 100" width="60" height="60">
                            <text x="50" y="55" font-size="16" font-weight="700" text-anchor="middle" fill="var(--color-text-primary)">NHL</text>
                        </svg>
                    </div>
                    <div class="deals-track">
                        <div class="year-grid">
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                        </div>
                        <div class="deal-bar traditional top"
                             data-start="2020" data-end="2021"
                             data-broadcaster="ESPN, Turner"
                             data-value="0.4"
                             data-type="traditional"
                             style="left: 0%; width: 12.5%;"
                             tabindex="0"
                             role="button"
                             aria-label="NHL deal with ESPN and Turner, 2020-2021, $0.4 billion per year">
                            ESPN, Turner
                        </div>
                        <div class="deal-bar streaming bottom"
                             data-start="2021" data-end="2035"
                             data-broadcaster="ESPN, Turner, ESPN+"
                             data-value="5.2"
                             data-type="streaming"
                             style="left: 6.25%; width: 93.75%;"
                             tabindex="0"
                             role="button"
                             aria-label="NHL deal with ESPN, Turner, ESPN+, 2021-2035, $5.2 billion">
                            ESPN, Turner, ESPN+
                        </div>
                    </div>
                    <div class="value-label">$6.5B</div>
                </div>

                <!-- NBA -->
                <div class="timeline-row" data-league="NBA">
                    <div class="league-icon">
                        <svg viewBox="0 0 100 100" width="60" height="60">
                            <text x="50" y="55" font-size="16" font-weight="700" text-anchor="middle" fill="var(--color-text-primary)">NBA</text>
                        </svg>
                    </div>
                    <div class="deals-track">
                        <div class="year-grid">
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                        </div>
                        <div class="deal-bar traditional top"
                             data-start="2020" data-end="2025"
                             data-broadcaster="ESPN, Turner"
                             data-value="2.7"
                             data-type="traditional"
                             style="left: 0%; width: 37.5%;"
                             tabindex="0"
                             role="button"
                             aria-label="NBA deal with ESPN and Turner, 2020-2025, $2.7 billion per year">
                            ESPN, Turner
                        </div>
                        <div class="deal-bar streaming bottom"
                             data-start="2025" data-end="2035"
                             data-broadcaster="Amazon, NBC, ESPN, WBD"
                             data-value="7.6"
                             data-type="streaming"
                             style="left: 31.25%; width: 68.75%;"
                             tabindex="0"
                             role="button"
                             aria-label="NBA deal with Amazon, NBC, ESPN, Warner Bros. Discovery, 2025-2035, $7.6 billion per year">
                            Amazon, NBC, ESPN, WBD
                        </div>
                    </div>
                    <div class="value-label">$4.0B</div>
                </div>

                <!-- NFL -->
                <div class="timeline-row" data-league="NFL">
                    <div class="league-icon">
                        <svg viewBox="0 0 100 100" width="60" height="60">
                            <text x="50" y="55" font-size="16" font-weight="700" text-anchor="middle" fill="var(--color-text-primary)">NFL</text>
                        </svg>
                    </div>
                    <div class="deals-track">
                        <div class="year-grid">
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                        </div>
                        <div class="deal-bar traditional top"
                             data-start="2023" data-end="2033"
                             data-broadcaster="CBS, Fox, NBC, ESPN"
                             data-value="110"
                             data-type="traditional"
                             style="left: 18.75%; width: 68.75%;"
                             tabindex="0"
                             role="button"
                             aria-label="NFL deal with CBS, Fox, NBC, ESPN, 2023-2033, $110 billion total">
                            CBS, Fox, NBC, ESPN
                        </div>
                        <div class="deal-bar streaming bottom"
                             data-start="2022" data-end="2033"
                             data-broadcaster="Amazon Prime Video"
                             data-value="1.0"
                             data-type="streaming"
                             style="left: 12.5%; width: 75%;"
                             tabindex="0"
                             role="button"
                             aria-label="NFL Thursday Night Football deal with Amazon Prime Video, 2022-2033, $1.0 billion per year">
                            Amazon Prime (TNF)
                        </div>
                    </div>
                    <div class="value-label">$3.0B</div>
                </div>

                <!-- MLB Row 1 -->
                <div class="timeline-row" data-league="MLB">
                    <div class="league-icon">
                        <svg viewBox="0 0 100 100" width="60" height="60">
                            <text x="50" y="55" font-size="16" font-weight="700" text-anchor="middle" fill="var(--color-text-primary)">MLB</text>
                        </svg>
                    </div>
                    <div class="deals-track">
                        <div class="year-grid">
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                            <div class="year-line"></div>
                        </div>
                        <div class="deal-bar traditional top"
                             data-start="2022" data-end="2028"
                             data-broadcaster="Fox, ESPN, Turner"
                             data-value="3.8"
                             data-type="traditional"
                             style="left: 12.5%; width: 43.75%;"
                             tabindex="0"
                             role="button"
                             aria-label="MLB deal with Fox, ESPN, Turner, 2022-2028, $3.8 billion">
                            Fox, ESPN, Turner
                        </div>
                        <div class="deal-bar streaming bottom"
                             data-start="2022" data-end="2029"
                             data-broadcaster="Apple TV+"
                             data-value="0.085"
                             data-type="streaming"
                             style="left: 12.5%; width: 50%;"
                             tabindex="0"
                             role="button"
                             aria-label="MLB Friday Night Baseball deal with Apple TV+, 2022-2029, $85 million per year">
                            Apple TV+ (Friday)
                        </div>
                    </div>
                    <div class="value-label">$2.0B</div>
                </div>

            </div>

            <div class="legend">
                <div class="legend-item">
                    <div class="legend-box traditional"></div>
                    <span>Traditional Broadcasters</span>
                </div>
                <div class="legend-item">
                    <div class="legend-box streaming"></div>
                    <span>Streaming Platforms</span>
                </div>
            </div>
        </div>

        <!-- Mobile Card View -->
        <div class="mobile-cards" id="mobile-cards">
            <!-- Cards generated by JavaScript -->
        </div>

        <div class="stats-panel">
            <h2 style="color: var(--color-darker-gray); margin-bottom: 0.5rem;">Deal Insights</h2>
            <div class="stats-grid" id="stats-grid">
                <div class="stat-item">
                    <div class="stat-value" id="total-deals">10</div>
                    <div class="stat-label">Total Deals</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="total-value">$24.5B</div>
                    <div class="stat-label">Combined Value</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="streaming-count">5</div>
                    <div class="stat-label">Streaming Deals</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="avg-duration">11 yrs</div>
                    <div class="stat-label">Avg Duration</div>
                </div>
            </div>
        </div>
    </div>

    <div class="tooltip" id="tooltip" role="tooltip"></div>

    <script>
        // Data structure for deals
        const deals = Array.from(document.querySelectorAll('.deal-bar')).map(bar => ({
            element: bar,
            league: bar.closest('.timeline-row').dataset.league,
            start: parseInt(bar.dataset.start),
            end: parseInt(bar.dataset.end),
            broadcaster: bar.dataset.broadcaster,
            value: parseFloat(bar.dataset.value),
            type: bar.dataset.type
        }));

        // Tooltip functionality
        const tooltip = document.getElementById('tooltip');

        function showTooltip(deal, event) {
            const years = deal.end - deal.start + 1;
            const annualValue = (deal.value / years).toFixed(2);

            tooltip.innerHTML = `
                <h3>${deal.league} Media Rights</h3>
                <div class="tooltip-row">
                    <span class="tooltip-label">Broadcaster:</span>
                    <span class="tooltip-value">${deal.broadcaster}</span>
                </div>
                <div class="tooltip-row">
                    <span class="tooltip-label">Period:</span>
                    <span class="tooltip-value">${deal.start}–${deal.end}</span>
                </div>
                <div class="tooltip-row">
                    <span class="tooltip-label">Duration:</span>
                    <span class="tooltip-value">${years} years</span>
                </div>
                <div class="tooltip-row">
                    <span class="tooltip-label">Total Value:</span>
                    <span class="tooltip-value">$${deal.value}B</span>
                </div>
                <div class="tooltip-row">
                    <span class="tooltip-label">Annual Value:</span>
                    <span class="tooltip-value">$${annualValue}B/year</span>
                </div>
                <div class="tooltip-row">
                    <span class="tooltip-label">Type:</span>
                    <span class="tooltip-value">${deal.type === 'traditional' ? 'Traditional' : 'Streaming'}</span>
                </div>
            `;

            positionTooltip(event);
            tooltip.classList.add('visible');
        }

        function positionTooltip(event) {
            const x = event.clientX;
            const y = event.clientY;
            const offset = 20;

            tooltip.style.left = (x + offset) + 'px';
            tooltip.style.top = (y + offset) + 'px';
        }

        function hideTooltip() {
            tooltip.classList.remove('visible');
        }

        // Add event listeners to all deal bars
        deals.forEach(deal => {
            deal.element.addEventListener('mouseenter', (e) => showTooltip(deal, e));
            deal.element.addEventListener('mousemove', positionTooltip);
            deal.element.addEventListener('mouseleave', hideTooltip);
            deal.element.addEventListener('focus', (e) => showTooltip(deal, e));
            deal.element.addEventListener('blur', hideTooltip);
        });

        // Filter by league
        let activeLeague = 'all';
        let activeType = 'all';

        function filterLeague(league) {
            activeLeague = league;
            applyFilters();

            // Update button states
            document.querySelectorAll('[data-league]').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.league === league);
            });
        }

        function filterType(type) {
            activeType = type;
            applyFilters();

            // Update button states
            document.querySelectorAll('[data-type]').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.type === type);
            });
        }

        function applyFilters() {
            const rows = document.querySelectorAll('.timeline-row');

            rows.forEach(row => {
                const league = row.dataset.league;
                const dealBars = row.querySelectorAll('.deal-bar');

                // Check if row should be visible based on league filter
                const leagueMatch = activeLeague === 'all' || league === activeLeague;

                if (!leagueMatch) {
                    row.style.display = 'none';
                } else {
                    row.style.display = 'flex';

                    // Filter individual deals by type
                    dealBars.forEach(bar => {
                        const type = bar.dataset.type;
                        const typeMatch = activeType === 'all' || type === activeType;
                        bar.style.opacity = typeMatch ? '1' : '0.2';
                        bar.style.pointerEvents = typeMatch ? 'auto' : 'none';
                    });
                }
            });

            updateStats();
        }

        // Year slider
        const yearSlider = document.getElementById('year-slider');
        const yearDisplay = document.getElementById('year-display');

        yearSlider.addEventListener('input', function() {
            const year = parseInt(this.value);
            yearDisplay.textContent = year;
            highlightActiveDeals(year);
        });

        function highlightActiveDeals(year) {
            deals.forEach(deal => {
                // Only highlight if deal passes current filters
                const leagueMatch = activeLeague === 'all' || deal.league === activeLeague;
                const typeMatch = activeType === 'all' || deal.type === activeType;

                if (!leagueMatch) {
                    return; // Row is hidden, skip
                }

                const isActive = year >= deal.start && year <= deal.end;

                if (typeMatch) {
                    deal.element.style.opacity = isActive ? '1' : '0.3';
                    deal.element.style.transform = isActive ? 'scaleY(1.1)' : 'scaleY(1)';
                } else {
                    deal.element.style.opacity = '0.15';
                    deal.element.style.transform = 'scaleY(1)';
                }
            });
        }

        function resetAll() {
            // Reset filters
            activeLeague = 'all';
            activeType = 'all';

            // Reset button states
            document.querySelectorAll('[data-league]').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.league === 'all');
            });
            document.querySelectorAll('[data-type]').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.type === 'all');
            });

            // Reset year slider
            yearSlider.value = 2025;
            yearDisplay.textContent = 2025;

            // Reset all deal bars
            deals.forEach(deal => {
                deal.element.style.opacity = '1';
                deal.element.style.transform = 'scaleY(1)';
                deal.element.style.pointerEvents = 'auto';
            });

            // Show all rows
            document.querySelectorAll('.timeline-row').forEach(row => {
                row.style.display = 'flex';
            });

            updateStats();
        }

        // Update statistics
        function updateStats() {
            const visibleDeals = deals.filter(deal => {
                const leagueMatch = activeLeague === 'all' || deal.league === activeLeague;
                const typeMatch = activeType === 'all' || deal.type === activeType;
                return leagueMatch && typeMatch;
            });

            const totalValue = visibleDeals.reduce((sum, deal) => sum + deal.value, 0);
            const streamingDeals = visibleDeals.filter(d => d.type === 'streaming').length;
            const avgDuration = visibleDeals.reduce((sum, deal) => sum + (deal.end - deal.start + 1), 0) / visibleDeals.length;

            document.getElementById('total-deals').textContent = visibleDeals.length;
            document.getElementById('total-value').textContent = '$' + totalValue.toFixed(1) + 'B';
            document.getElementById('streaming-count').textContent = streamingDeals;
            document.getElementById('avg-duration').textContent = Math.round(avgDuration) + ' yrs';
        }

        // Generate mobile cards
        function generateMobileCards() {
            const container = document.getElementById('mobile-cards');
            container.innerHTML = deals.map((deal, index) => {
                const years = deal.end - deal.start + 1;
                const valueDisplay = deal.value >= 1 ? `$${deal.value}B` : `$${(deal.value * 1000).toFixed(0)}M`;

                return `
                    <div class="mobile-card ${deal.type}"
                         data-index="${index}"
                         data-league="${deal.league}"
                         data-type="${deal.type}"
                         data-start="${deal.start}"
                         data-end="${deal.end}">
                        <div class="mobile-card-header">
                            <span class="mobile-card-league">${deal.league}</span>
                            <span class="mobile-card-badge ${deal.type}">${deal.type}</span>
                        </div>
                        <div class="mobile-card-broadcaster">${deal.broadcaster}</div>
                        <div class="mobile-card-details">
                            <div class="mobile-card-detail">
                                <span class="mobile-card-detail-label">Period</span>
                                <span class="mobile-card-detail-value">${deal.start}–${deal.end}</span>
                            </div>
                            <div class="mobile-card-detail">
                                <span class="mobile-card-detail-label">Duration</span>
                                <span class="mobile-card-detail-value">${years} years</span>
                            </div>
                            <div class="mobile-card-detail">
                                <span class="mobile-card-detail-label">Value</span>
                                <span class="mobile-card-detail-value">${valueDisplay}</span>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Filter mobile cards
        function filterMobileCards() {
            const year = parseInt(yearSlider.value);
            const cards = document.querySelectorAll('.mobile-card');

            cards.forEach(card => {
                const league = card.dataset.league;
                const type = card.dataset.type;
                const start = parseInt(card.dataset.start);
                const end = parseInt(card.dataset.end);

                const leagueMatch = activeLeague === 'all' || league === activeLeague;
                const typeMatch = activeType === 'all' || type === activeType;
                const yearMatch = year >= start && year <= end;

                if (leagueMatch && typeMatch) {
                    card.classList.remove('hidden');
                    card.style.opacity = yearMatch ? '1' : '0.5';
                } else {
                    card.classList.add('hidden');
                }
            });
        }

        // Update applyFilters to also filter mobile cards
        const originalApplyFilters = applyFilters;
        applyFilters = function() {
            originalApplyFilters();
            filterMobileCards();
        };

        // Update year slider to also filter mobile cards
        yearSlider.addEventListener('input', filterMobileCards);

        // Update resetAll to also reset mobile cards
        const originalResetAll = resetAll;
        resetAll = function() {
            originalResetAll();
            filterMobileCards();
        };

        // Initialize
        generateMobileCards();
        updateStats();
    </script>
</body>
</html>
